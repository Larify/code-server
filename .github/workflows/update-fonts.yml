name: Update Nerd Fonts

on:
  workflow_dispatch:
  schedule:
    - cron: '0 15 * * *'

jobs:
  docker:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - name: Download Nerd Fonts
        run: |
          mkdir -p src/fonts
          INSTALL_FONTS=(Hack JetBrainsMono)
          for i in ${INSTALL_FONTS[@]}; do
            echo "Downloading font ${i} ==> https://github.com/ryanoasis/nerd-fonts/releases/latest/download/${i}.zip"
            wget -q https://github.com/ryanoasis/nerd-fonts/releases/latest/download/${i}.zip
            echo "Unzipping font ${i}.zip"
            unzip -q -o ${i}.zip -d src/fonts
            rm -rf src/fonts/*.md
            rm -rf src/fonts/*.txt
            rm -rf ${i}.zip
          done

      - name: Commit changes
        run: |
          git config user.name "${{ github.actor }}"
          git config user.email "${{ github.actor }}@users.noreply.github.com"
          git add -A
          git diff-index --quiet HEAD || git commit -m 'Update Nerd Fonts'
          git push

      - name: Push changes
        uses: ad-m/github-push-action@master
        with:
          github_token: ${{ secrets.ACTIONS_TRIGGER_PAT }}
          force: true
